{% extends "base.html" %}
{% load crispy_forms_tags %}
{% load static %}

{% block content %}
<div class="container mt-5">
    <h2 class="text-center">Create a New Trip</h2>
    
    <!-- Progress Bar -->
    <div class="progress mt-4">
        <div class="progress-bar" role="progressbar" id="progressBar">Step 1 of 5</div>
    </div>

    <form method="POST" id="tripForm">
        {% csrf_token %}

<!-- Step 1: Basic Trip Details -->
<div class="form-step active">
    <h4>Step 1: Basic Trip Details</h4>
    {{ form.trip_name|as_crispy_field }}
   
    <label for="id_country">Country:</label>
    <input type="text" id="id_country" class="form-control" placeholder="Start typing a country..." required>
    
    <label for="cities">Select Cities:</label>
    <input type="text" id="cities" class="form-control" placeholder="Start typing a city..." required>

    <ul id="selected-cities" class="list-group mt-2"></ul>
    <input type="hidden" name="selected-cities" id="selected-cities_input">
    
    <!-- Validation errors -->
    <span id="city-error" class="text-danger"></span>  

    <button type="button" class="btn btn-primary next-step">Next</button>
</div>

        <!-- Step 2: Travel Dates & Budget -->
        <div class="form-step">
            <h4>Step 2: Travel Dates & Budget</h4>
            {{ form.start_date|as_crispy_field }}
            {{ form.end_date|as_crispy_field }}
            {{ form.budget|as_crispy_field }}
                     

            <button type="button" class="btn btn-secondary prev-step">Back</button>
            <button type="button" class="btn btn-primary next-step">Next</button>
        </div>

        <!-- Step 3: Accommodation & Transport -->
        <div class="form-step">
            <h4>Step 3: Accommodation & Transport</h4>
            {{ form.accommodation_name|as_crispy_field }}
            {{ form.accommodation_type|as_crispy_field }}
            {{ form.transport_mode|as_crispy_field }}
            <button type="button" class="btn btn-secondary prev-step">Back</button>
            <button type="button" class="btn btn-primary next-step">Next</button>
        </div>

        <!-- Step 4: Itinerary & Wishlist -->
        <div class="form-step">
            <h4>Step 4: Itinerary & Wishlist</h4>
            <label for="itinerary">Daily Itinerary</label>
            <textarea class="form-control" name="itinerary" id="itinerary" rows="3"></textarea>

            <label for="wishlist">Add places to your wishlist:</label>
            <input type="text" id="wishlist" class="form-control" placeholder="Search places..." required>



            <button type="button" class="btn btn-secondary prev-step">Back</button>
            <button type="button" class="btn btn-primary next-step">Next</button>
        </div>

        <!-- Step 5: Review & Submit -->
        <div class="form-step">
            <h4>Step 5: Review & Submit</h4>
            <p>Review your trip details before submitting.</p>
            <button type="button" class="btn btn-secondary prev-step">Back</button>
            <button type="submit" class="btn btn-success">Submit Trip</button>
        </div>
    </form>
</div>
{% endblock %}

{% block extra_js %}
{% if google_api_key %}
    <script src="https://maps.googleapis.com/maps/api/js?key={{ google_api_key }}&libraries=places"></script>
{% endif %}

    <script src="{% static 'js/trip_form.js' %}"></script>
{% endblock %}
