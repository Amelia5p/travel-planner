{% extends "base.html" %}
{% load crispy_forms_tags %}
{% load static %}

{% block content %}



<script src="{% static 'js/trip_form.js' %}"></script>

<div class="container mt-5">
    <h2 class="text-center">{% if editing %}Edit Trip{% else %}Create a New Trip{% endif %}</h2>
    
    <!-- Progress Bar -->
    <div class="progress mt-4">
        <div class="progress-bar" role="progressbar" id="progressBar" style="width: 20%;">Step 1 of 5</div>
    </div>
    
    <div class="card mt-4 mb-4">
        <div class="card-body">
            <form method="post" id="tripForm">
                {% csrf_token %}
                
                <!-- Step 1: Basic Info -->
                <div class="form-step" id="step1">
                    <h3>Basic Trip Information</h3>
                    <div class="form-group">
                        {{ form.trip_name|as_crispy_field }}
                    </div>
                    <div class="form-group">
                        <label for="id_country">Country</label>
                        <input type="text" id="id_country" name="country" class="form-control" placeholder="Type a country or select from dropdown" required>
                        <small class="form-text text-muted">Start typing a country name to see suggestions</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="id_cities">Cities</label>
                        <input type="text" id="id_cities" name="cities" class="form-control" placeholder="Type a city or select from dropdown" required>
                        <small class="form-text text-muted">Start typing a city name to see suggestions</small>
                    </div>
                    
                    <div class="text-right mt-4">
                        <button type="button" class="btn btn-primary next-step">Next</button>
                    </div>
                </div>
                
                <!-- Step 2: Dates -->
                <div class="form-step" id="step2" style="display: none;">
                    <h3>Trip Dates</h3>
                    <div class="row">
                        <div class="col-md-6">
                            {{ form.start_date|as_crispy_field }}
                        </div>
                        <div class="col-md-6">
                            {{ form.end_date|as_crispy_field }}
                        </div>
                    </div>
                    <div class="text-right mt-4">
                        <button type="button" class="btn btn-secondary prev-step">Previous</button>
                        <button type="button" class="btn btn-primary next-step">Next</button>
                    </div>
                </div>
                
                <!-- Step 3: Budget -->
                <div class="form-step" id="step3" style="display: none;">
                    <h3>Budget Information</h3>
                    <div class="form-group">
                        {{ form.budget|as_crispy_field }}
                    </div>
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle"></i> Your budget helps with trip planning and expense tracking.
                    </div>
                    <div class="text-right mt-4">
                        <button type="button" class="btn btn-secondary prev-step">Previous</button>
                        <button type="button" class="btn btn-primary next-step">Next</button>
                    </div>
                </div>
                
                <!-- Step 4: Accommodation -->
                <div class="form-step" id="step4" style="display: none;">
                    <h3>Accommodation & Transport</h3>
                    <div class="row">
                        <div class="col-md-6">
                            {{ form.accommodation_name|as_crispy_field }}
                            <small class="form-text text-muted">Start typing a hotel or accommodation name</small>
                        </div>
                        <div class="col-md-6">
                            {{ form.accommodation_type|as_crispy_field }}
                        </div>
                    </div>
                    <div class="form-group">
                        {{ form.transport_mode|as_crispy_field }}
                    </div>
                    <div class="text-right mt-4">
                        <button type="button" class="btn btn-secondary prev-step">Previous</button>
                        <button type="button" class="btn btn-primary next-step">Next</button>
                    </div>
                </div>
                
                <!-- Step 5: Itinerary -->
                <div class="form-step" id="step5" style="display: none;">
                    <h3>Trip Itinerary</h3>
                    <div class="form-group">
                        {{ form.itinerary|as_crispy_field }}
                    </div>
                    <div class="text-right mt-4">
                        <button type="button" class="btn btn-secondary prev-step">Previous</button>
                        <button type="submit" class="btn btn-success">Save Trip</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
{% if google_api_key %}
    <script src="https://maps.googleapis.com/maps/api/js?key={{ google_api_key }}&libraries=places"></script>
{% endif %}

<script src="{% static 'js/trip_form.js' %}"></script>
{% endblock %}